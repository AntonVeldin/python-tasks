# Аналог утилиты tail

## Задача

### Описание

Написать на Python CLI приложение, аналогичное утилите tail. Нужно поддерживать флаг -f. Только один файл на вход. Достаточно обеспечить работу с обычными файлами (потоки не нужны). Можно использовать библиотеки для всего, кроме основного функционала.
После выполнения задания нужно описать текстом принятые технические решения. Как будто пишешь отчет после выполнения проекта.

### Понимание

Основной функционал:

1. Чтение файла
2. Определение строк для вывода
3. Поддержка флага `-f`\*
4. Вывод

> *`-f`: Don't stop when end of file is reached, but rather to wait for additional data to be appended to the input.

[Исходный код tail на С](https://github.com/coreutils/coreutils/blob/master/src/tail.c).

[Описание функционала tail на MacOS.](https://ss64.com/osx/tail.html)


## Реализация

### Описание
Весь функционал размещен в модуле `tail.py`.

Python CLI: `tail.py [-f] [-n N] file_name`

При запуске скрипта производится чтение файла `file_name` и вывод строк в соответствии с переданным числовым параметром вместе с маркером `-n`.

Осуществляется вывод уведомления и остановка программы, если файл не найден.

Поддерживается работа только с одним файлом.

Файл целиком загружается в память и далее обрабатывается.
В случае, когда размер файла превышает размер доступной оперативной памяти - возвращает ошибку.

Режим `--follow` запускает бесконечный цикл, в результате которого  вычисляется количество строк и сверяется с тем, которое было получено ранее.
Если количество строк изменилось в большую сторону, выводятся все новые строки.

### CLI
Для реализации консольного интерфейса рассмотрены библиотеки:
* [argparse](https://docs.python.org/3/howto/argparse.html)
* [click](https://click.palletsprojects.com/en/8.0.x/)
* [fire](https://dev-gang.ru/article/sozdanie-interfeisov-komandnoi-stroki-cli-s-pomosczu-fire-v-python-eazli6ryg7/)

Парсинг аргументов реализован с помощью модуля `argparse` т.к. он входит в стандартный набор библиотек.
В нашем случае `argparse` закрывает все потребности без необходимости подключать сторонние модули.

#### Необязательные аргументы:

* `[-n N]` - количество строк. Значение по умолчанию `-10`.
  Поддерживает два варианта:
  * Количество строк с конца файла, если передано отрицательное значение.
  * Номер строки с начала файла, с которой выводятся все оставшиеся строки, если передано положительное значение.
* `[-f]`/ `[--follow]` - флаг включает режим отслеживания, когда программа не останавливает работу, а новые строки выводятся в терминал по мере добавления в файл. Захват ручного ввода не предусмотрен.

#### Обязательный аргумент:

* `file_name` - текстовый файл или путь до файла.

#### Возможные команды:
```bash
python tail.py -h
# Вызов справки.

python tail.py log.txt
# Вывод последних десяти строк файла.

python tail.py -f log.txt
python tail.py --follow log.txt
# Вывод последних десяти строк файла и последующий вывод добавляемых строк.

python tail.py -n-3 log.txt
python tail.py -n -3 log.txt
# вывод последних трех строк файла.

python tail.py -f -n -3 log.txt
python tail.py -n-3 -f log.txt
# вывод последних трех строк файла и последующий вывод добавляемых строк.

python tail.py -n+4 log.txt
python tail.py -n 4 log.txt
python tail.py -n4 log.txt
# Вывод всех строк, начиная с четвертой.

python tail.py -n 4 -f log.txt
python tail.py -f -n4 log.txt
# Вывод всех строк, начиная с четвертой и последующий вывод добавляемых строк.
```

## Вспомогательный модуль
Модуль `add_line.py` написан для оперативной проверки корректной работы `tail.py`.

В модуле также реализован консольный интерфейс.
```bash
python add_lines.py n
```
Проверяет, создан ли файл `log.txt` в текущей директории и создает, если файл не найден.
Добавляет `n` строк в конец файла увеличивая каждую новую запись на 1.

#### Обязательный аргумент:

* `n` - число строк для добавления в файл `log.txt`.


## Вопросы

1. Необходимо ли поддерживать доп. флаги?
    > `-b number`: the location is number 512-byte blocks

    > `-c number`: the location is number bytes

2. Есть ли потребность в функционале для обработки файлов значительного размера, которые могут вызвать ошибку из-за нехватки оперативной памяти.
